cask "font-sf-armenian" do
  version "19.0d5e1,20.0d1e1"

  on_macos do
    depends_on formula: "fonttools"
    depends_on formula: "p7zip"

    url "https://devimages-cdn.apple.com/design/resources/download/SF-Armenian.dmg"
    sha256 "ffd715ae93d7c215be3f434b84624184779bb50b2bb3d66b8fd42880c65fadad"

    preflight do
      system_command "/bin/bash", args: [
        "-c", <<~SHELL
          mkdir -p '#{staged_path}/tmp/' \
          && '#{HOMEBREW_PREFIX}/opt/p7zip/bin/7z' -txar e \
          '#{staged_path}/SF Armenian Fonts.pkg' -y -o'#{staged_path}/tmp/' \
          && '#{HOMEBREW_PREFIX}/opt/p7zip/bin/7z' -tgzip e \
          '#{staged_path}/tmp/Payload' -y -o'#{staged_path}/tmp/' \
          && '#{HOMEBREW_PREFIX}/opt/p7zip/bin/7z' -tcpio e \
          '#{staged_path}/tmp/Payload~' './Library/Fonts/*' -o'#{staged_path}/Fonts' \
          && cp '#{staged_path}/tmp/License.rtf' '#{staged_path}/License.rtf' \
          && rm -r '#{staged_path}/tmp/' \
          && ls '#{staged_path}/Fonts/'* \
          | awk '{print "\\"" $0 "\\""}' \
          | xargs '#{HOMEBREW_PREFIX}/opt/fonttools/bin/fonttools' ttLib \
          -o '#{staged_path}/SF-Armenian.ttc'
        SHELL
      ]
    end
  end

  on_linux do
    sha256 "92a9243f2282f58beb736e3cab56068a5f1c95ba956e52fbaa96a1c43613126e"

    url "https://api.github.com/repos/BingoKingo/homebrew-private/releases/assets/280250024",
        verified: "github.com/",
        header:   ["Accept: application/octet-stream",
                   "Authorization: Bearer #{ENV.fetch("HOMEBREW_GITHUB_API_TOKEN", nil)}",
                   "X-GitHub-Api-Version: 2022-11-28"]
  end

  name "San Francisco Armenian"
  name "SF Armenian"
  homepage "https://developer.apple.com/fonts/"

  font "SF-Armenian.ttc"

  caveats do
    license "#{staged_path}/License.rtf" if OS.mac?
    <<~EOS
      [L] Private files cannot be downloaded without permission.

      You can preview font information generated by `otfinfo` at:
        #{__dir__}/#{token}.otfinfo
    EOS
  end
end
