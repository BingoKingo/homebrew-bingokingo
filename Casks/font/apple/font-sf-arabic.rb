cask "font-sf-arabic" do
  version "20.0d1e1,20.0d1e2"

  on_macos do
    depends_on formula: "fonttools"
    depends_on formula: "p7zip"

    url "https://devimages-cdn.apple.com/design/resources/download/SF-Arabic.dmg"
    sha256 "2760c62d502b77012c49517c2ea392ec2d4c647fe060985c927df48d105197b9"

    preflight do
      system_command "/bin/bash", args: [
        "-c", <<~SHELL
          mkdir -p '#{staged_path}/tmp/' \
          && '#{HOMEBREW_PREFIX}/opt/p7zip/bin/7z' -txar e \
          '#{staged_path}/SF Arabic Fonts.pkg' -y -o'#{staged_path}/tmp/' \
          && '#{HOMEBREW_PREFIX}/opt/p7zip/bin/7z' -tgzip e \
          '#{staged_path}/tmp/Payload' -y -o'#{staged_path}/tmp/' \
          && '#{HOMEBREW_PREFIX}/opt/p7zip/bin/7z' -tcpio e \
          '#{staged_path}/tmp/Payload~' './Library/Fonts/*' -o'#{staged_path}/Fonts' \
          && cp '#{staged_path}/tmp/License.rtf' '#{staged_path}/License.rtf' \
          && rm -r '#{staged_path}/tmp/' \
          && ls '#{staged_path}/Fonts/'* \
          | awk '{print "\\"" $0 "\\""}' \
          | xargs '#{HOMEBREW_PREFIX}/opt/fonttools/bin/fonttools' ttLib \
          -o '#{staged_path}/SF-Arabic.ttc'
        SHELL
      ]
    end
  end

  on_linux do
    sha256 "643e04537a5db4e2b350de8619aa34462af99549da0d5a4725e44febc7172833"

    url "https://api.github.com/repos/BingoKingo/homebrew-private/releases/assets/280250053",
        verified: "github.com/",
        header:   ["Accept: application/octet-stream",
                   "Authorization: Bearer #{ENV.fetch("HOMEBREW_GITHUB_API_TOKEN", nil)}",
                   "X-GitHub-Api-Version: 2022-11-28"]
  end

  name "San Francisco Arabic"
  name "SF Arabic"
  homepage "https://developer.apple.com/fonts/"

  font "SF-Arabic.ttc"

  caveats do
    <<~EOS
      \033[1m[L]\033[0m Private files cannot be downloaded without permission.

      # Generated by `otfinfo`
      Family:                 SF Arabic               SF Arabic Rounded
      Subfamily:              Regular                 Regular
      Full name:              SF Arabic               SF Arabic Rounded
      PostScript name:        SFArabic-Regular        SFArabicRounded-Regular
      Preferred family:       SF Arabic               SF Arabic Rounded
      Version:                Version 20.0d1e2        Version 20.0d1e1
      Unique ID:              SF Arabic; 20.0d1e2;    SF Arabic Rounded;
                              2024-04-19              20.0d1e1; 2024-03-12
      Description:            Apple Inc.
      Designer:               Apple Inc.
      Designer URL:           http://www.apple.com/
      Manufacturer:           Apple Inc.
      Vendor URL:             http://www.apple.com/
      Trademark:              Apple Inc.
      Copyright:              Copyright (c) 2024 Apple Inc. All rights reserved.
      License URL:            http://www.apple.com/
      License Description:    This SF Arabic Font (the “Apple Font”) is licensed to you by Apple Inc. (“Apple”) in consideration of your agreement to the following terms and the terms of the License Agreement for the Apple SF Arabic Font that was presented upon the downloading of the Apple Font. If you do not agree with these terms and the terms of the License Agreement for the Apple SF Arabic Font, do not use the Apple Font.
      You may use the Apple Font solely for creating mock-ups of user interfaces to be used in software products running on Apple’s iOS, iPadOS, macOS, tvOS or watchOS operating systems, as applicable. The foregoing right includes the right to show the Apple Font in screen shots, images, mock-ups or other depictions, digital and/or print, of such software products running solely on iOS, iPadOS, macOS, tvOS or watchOS.
      The grants set forth in this License do not permit you to, and you agree not to, install, use or run the Apple Font for the purpose of creating mock-ups of user interfaces to be used in software products running on any non-Apple operating system or to enable others to do so. You may not embed the Apple Font in any software programs or other products. Except as expressly provided for herein, you may not use the Apple Font to, create, develop, display or otherwise distribute any documentation, artwork, website content or any other work product.
      You may use the Apple Font: (i) only for the purposes described in this License and the License Agreement for the Apple SF Arabic Font; and (ii) only if you are a Registered Apple Developer, or as otherwise expressly permitted by Apple in writing.
      Vendor ID:              APPL
      Permissions:            Preview & Print
      Axis 0:                 wght                    wght
      Axis 0 name:            Weight                  Weight
      Axis 0 range:           1 1000                  1 1000
      Axis 0 default:         400                     400
      Axis 1:                 opsz                    opsz
      Axis 1 name:            Optical Size            Optical Size
      Axis 1 range:           17 80                   17 80
      Axis 1 default:         28                      28
      Instance 0 name:        Ultralight              Ultralight
      Instance 0 position:    1 28                    1 28
      Instance 1 name:        Thin                    Thin
      Instance 1 position:    100.75 28               100.75 28
      Instance 2 name:        Light                   Light
      Instance 2 position:    267 28                  267 28
      Instance 3 name:        Regular                 Regular
      Instance 3 position:    400 28                  400 28
      Instance 4 name:        Medium                  Medium
      Instance 4 position:    511.111114502 28        511.111114502 28
      Instance 5 name:        Semibold                Semibold
      Instance 5 position:    622.222229004 28        622.222229004 28
      Instance 6 name:        Bold                    Bold
      Instance 6 position:    711.111114502 28        711.111114502 28
      Instance 7 name:        Heavy                   Heavy
      Instance 7 position:    I844.444442749 28       844.444442749 28
      Instance 8 name:        Black                   Black
      Instance 8 position:    1000 28                 1000 28
    EOS
  end
end
